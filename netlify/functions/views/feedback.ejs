<!doctype html>
<html>

<link rel="stylesheet" href="/stylesheets/feedback.css">


<%- include('includes/head') %>



<body>

    <%- include('includes/navbar') %>

    <section class="feedback" id="feedback">

    <div class="feedback-content">

    <h2>Feedback</h2>

    <div class="feedback-options">

        <h3>Give us feedback</h3>
        <h3>|</h3>
        <h3>Submit your challenge idea</h3>
    </div>

    <div class="feedback-post">

        <div class="feedback-col">

            <p>Your opinion matters to us!</p>
            <form class="feedback-post-content" action="/feedback" method="POST" >
    
                <textarea class="field-text" lang="en" placeholder="Give us your feedback" name="text"></textarea>
                <input type="hidden" name="profile_id" id="profile_id" value="profile_id">


                <button class="nav-neon-button" id="login-button">
                    <span class="nav-neon-button-text">
                         Submit</span>
                  </button>
                
            </form>
        </div>

    </div>

    <div class="feedback-messages">
        <% feedback.forEach(function(item) { %>
            <div class="feedback-messages-col">
                <p>"<%= item.message %>" - <%= item.profile_id ? item.profile_id : 'Anonymous' %></p>

                <p id="messageOwner"><%= item.profile_id ? item.profile_id : 'Anonymous' %></p>


                <div class="votes-handling">  

                    <button class="feedback-neon-button"  data-id="<%= item.id %>">
                        <span class="feedback-neon-button-text">
                             ^</span>
                      </button>
                    
                    <p id="votes-<%= item.id %>"><%= item.votes %></p>


                
                </div>

              
            </div>
        <% }); %>
    </div>
    

</div>



    </section>

    <script src="/feedback.js"></script>

    <script>
        // Retrieve profileId from localStorage
        const profileId = localStorage.getItem("profileId");
    
        // Iterate through feedback messages and check ownership
        document.querySelectorAll('#messageOwner').forEach((messageOwner) => {



            console.log(messageOwner.textContent)

            
          




    
          if (messageOwner.textContent === profileId) {
                 const textToChange = messageOwner
                
               textToChange.textContent="mine";
        }
        });
    </script>
    

    

    <script>

        let profile_id 
        
        profile_id = localStorage.getItem("profileId")

        if (!profile_id ) {
               profile_id = null 
            }

            document.getElementById("profile_id").value = profile_id;




    </script>


</body>

<%- include('includes/footer') %>

</html>
